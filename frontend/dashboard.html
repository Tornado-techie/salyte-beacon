<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard - Salyte Beacon</title>
    
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Chart.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    
    <!-- Leaflet CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css">
    
    <!-- Custom CSS -->
    <link rel="stylesheet" href="dashboard.css">
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-primary sticky-top">
        <div class="container">
            <a class="navbar-brand" href="index.html">
                <i class="fas fa-tint me-2"></i>
                Salyte Beacon
            </a>
            
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav me-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="index.html">Home</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link active" href="dashboard.html">Dashboard</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="ai.html">AI Assistant</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="report.html">Community Reports</a>
                    </li>
                </ul>
                
                <div class="navbar-nav">
                    <div class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown">
                            <i class="fas fa-user-circle me-1"></i>
                            Profile
                        </a>
                        <ul class="dropdown-menu">
                            <li><a class="dropdown-item" href="#"><i class="fas fa-cog me-2"></i>Settings</a></li>
                            <li><a class="dropdown-item" href="#"><i class="fas fa-bell me-2"></i>Notifications</a></li>
                            <li><hr class="dropdown-divider"></li>
                            <li><a class="dropdown-item" href="#"><i class="fas fa-sign-out-alt me-2"></i>Logout</a></li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <div class="container-fluid py-4">
        <!-- Page Header -->
        <div class="row mb-4">
            <div class="col-12">
                <div class="page-header">
                    <h1 class="page-title">
                        <i class="fas fa-tachometer-alt me-3"></i>
                        Water Quality Dashboard
                    </h1>
                    <p class="page-subtitle">Real-time monitoring and analytics for water quality across Kenya</p>
                    
                    <div class="page-actions">
                        <button class="btn btn-outline-primary me-2" id="refreshData">
                            <i class="fas fa-sync-alt me-1"></i>Refresh Data
                        </button>
                        <button class="btn btn-primary" id="exportDashboard">
                            <i class="fas fa-download me-1"></i>Export Report
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Key Metrics -->
        <div class="row mb-4">
            <div class="col-lg-3 col-md-6 mb-3">
                <div class="metric-card">
                    <div class="metric-icon bg-primary">
                        <i class="fas fa-tint"></i>
                    </div>
                    <div class="metric-content">
                        <h3 class="metric-value" id="totalStations">245</h3>
                        <p class="metric-label">Monitoring Stations</p>
                        <span class="metric-trend positive">
                            <i class="fas fa-arrow-up"></i>
                            +12 this month
                        </span>
                    </div>
                </div>
            </div>

            <div class="col-lg-3 col-md-6 mb-3">
                <div class="metric-card">
                    <div class="metric-icon bg-success">
                        <i class="fas fa-check-circle"></i>
                    </div>
                    <div class="metric-content">
                        <h3 class="metric-value" id="safeStations">187</h3>
                        <p class="metric-label">Safe Water Sources</p>
                        <span class="metric-trend positive">
                            <i class="fas fa-arrow-up"></i>
                            76.3%
                        </span>
                    </div>
                </div>
            </div>

            <div class="col-lg-3 col-md-6 mb-3">
                <div class="metric-card">
                    <div class="metric-icon bg-warning">
                        <i class="fas fa-exclamation-triangle"></i>
                    </div>
                    <div class="metric-content">
                        <h3 class="metric-value" id="alertStations">34</h3>
                        <p class="metric-label">Stations with Alerts</p>
                        <span class="metric-trend negative">
                            <i class="fas fa-arrow-down"></i>
                            -8 from last week
                        </span>
                    </div>
                </div>
            </div>

            <div class="col-lg-3 col-md-6 mb-3">
                <div class="metric-card">
                    <div class="metric-icon bg-danger">
                        <i class="fas fa-times-circle"></i>
                    </div>
                    <div class="metric-content">
                        <h3 class="metric-value" id="criticalStations">24</h3>
                        <p class="metric-label">Critical Issues</p>
                        <span class="metric-trend negative">
                            <i class="fas fa-arrow-up"></i>
                            +3 urgent
                        </span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Charts Section -->
        <div class="row mb-4">
            <!-- Water Quality Trends -->
            <div class="col-lg-8 mb-4">
                <div class="chart-card">
                    <div class="chart-header">
                        <h5 class="chart-title">
                            <i class="fas fa-chart-line me-2"></i>
                            Water Quality Trends (Last 30 Days)
                        </h5>
                        <div class="chart-controls">
                            <select class="form-select form-select-sm" id="trendTimeframe">
                                <option value="7">Last 7 days</option>
                                <option value="30" selected>Last 30 days</option>
                                <option value="90">Last 3 months</option>
                                <option value="365">Last year</option>
                            </select>
                        </div>
                    </div>
                    <div class="chart-body">
                        <canvas id="waterQualityChart"></canvas>
                    </div>
                </div>
            </div>

            <!-- Issue Distribution -->
            <div class="col-lg-4 mb-4">
                <div class="chart-card">
                    <div class="chart-header">
                        <h5 class="chart-title">
                            <i class="fas fa-chart-pie me-2"></i>
                            Issue Distribution
                        </h5>
                    </div>
                    <div class="chart-body">
                        <canvas id="issueDistributionChart"></canvas>
                        <div class="chart-legend mt-3">
                            <div class="legend-item">
                                <span class="legend-color" style="background: #dc3545;"></span>
                                Contamination (42%)
                            </div>
                            <div class="legend-item">
                                <span class="legend-color" style="background: #fd7e14;"></span>
                                Infrastructure (28%)
                            </div>
                            <div class="legend-item">
                                <span class="legend-color" style="background: #ffc107;"></span>
                                Shortage (20%)
                            </div>
                            <div class="legend-item">
                                <span class="legend-color" style="background: #17a2b8;"></span>
                                Quality (10%)
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Map and Recent Reports -->
        <div class="row mb-4">
            <!-- Interactive Map -->
            <div class="col-lg-8 mb-4">
                <div class="map-card">
                    <div class="map-header">
                        <h5 class="map-title">
                            <i class="fas fa-map-marked-alt me-2"></i>
                            Water Quality Map
                        </h5>
                        <div class="map-controls">
                            <div class="btn-group" role="group">
                                <input type="radio" class="btn-check" name="mapView" id="stations" checked>
                                <label class="btn btn-outline-primary btn-sm" for="stations">Stations</label>

                                <input type="radio" class="btn-check" name="mapView" id="reports">
                                <label class="btn btn-outline-primary btn-sm" for="reports">Reports</label>

                                <input type="radio" class="btn-check" name="mapView" id="heatmap">
                                <label class="btn btn-outline-primary btn-sm" for="heatmap">Heatmap</label>
                            </div>
                        </div>
                    </div>
                    <div class="map-body">
                        <div id="dashboardMap"></div>
                        <div class="map-legend">
                            <div class="legend-item">
                                <span class="station-marker safe"></span>
                                Safe (pH 6.5-8.5)
                            </div>
                            <div class="legend-item">
                                <span class="station-marker warning"></span>
                                Warning (pH 6.0-6.5, 8.5-9.0)
                            </div>
                            <div class="legend-item">
                                <span class="station-marker critical"></span>
                                Critical (pH <6.0, >9.0)
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Recent Reports -->
            <div class="col-lg-4 mb-4">
                <div class="reports-card">
                    <div class="reports-header">
                        <h5 class="reports-title">
                            <i class="fas fa-exclamation-triangle me-2"></i>
                            Recent Alerts
                        </h5>
                        <a href="community.html" class="view-all-link">
                            View All <i class="fas fa-arrow-right"></i>
                        </a>
                    </div>
                    <div class="reports-body">
                        <div id="recentReportsList">
                            <!-- Reports will be loaded here -->
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Detailed Analytics -->
        <div class="row mb-4">
            <!-- County Analysis -->
            <div class="col-lg-6 mb-4">
                <div class="analytics-card">
                    <div class="analytics-header">
                        <h5 class="analytics-title">
                            <i class="fas fa-map-marker-alt me-2"></i>
                            County-wise Analysis
                        </h5>
                        <div class="analytics-controls">
                            <select class="form-select form-select-sm" id="countyMetric">
                                <option value="quality">Water Quality</option>
                                <option value="reports">Report Count</option>
                                <option value="coverage">Coverage</option>
                            </select>
                        </div>
                    </div>
                    <div class="analytics-body">
                        <canvas id="countyAnalysisChart"></canvas>
                    </div>
                </div>
            </div>

            <!-- Quality Parameters -->
            <div class="col-lg-6 mb-4">
                <div class="analytics-card">
                    <div class="analytics-header">
                        <h5 class="analytics-title">
                            <i class="fas fa-flask me-2"></i>
                            Water Quality Parameters
                        </h5>
                        <div class="analytics-controls">
                            <select class="form-select form-select-sm" id="parameterStation">
                                <option value="all">All Stations Average</option>
                                <option value="nairobi-central">Nairobi Central</option>
                                <option value="mombasa-port">Mombasa Port</option>
                                <option value="kisumu-lake">Kisumu Lake</option>
                            </select>
                        </div>
                    </div>
                    <div class="analytics-body">
                        <div class="parameter-grid">
                            <div class="parameter-item">
                                <div class="parameter-label">pH Level</div>
                                <div class="parameter-value">7.2</div>
                                <div class="parameter-status safe">Normal</div>
                                <div class="parameter-bar">
                                    <div class="parameter-progress" style="width: 72%"></div>
                                </div>
                            </div>
                            <div class="parameter-item">
                                <div class="parameter-label">Dissolved Oxygen</div>
                                <div class="parameter-value">8.5 mg/L</div>
                                <div class="parameter-status safe">Good</div>
                                <div class="parameter-bar">
                                    <div class="parameter-progress" style="width: 85%"></div>
                                </div>
                            </div>
                            <div class="parameter-item">
                                <div class="parameter-label">Turbidity</div>
                                <div class="parameter-value">2.1 NTU</div>
                                <div class="parameter-status warning">Moderate</div>
                                <div class="parameter-bar">
                                    <div class="parameter-progress warning" style="width: 42%"></div>
                                </div>
                            </div>
                            <div class="parameter-item">
                                <div class="parameter-label">Temperature</div>
                                <div class="parameter-value">24°C</div>
                                <div class="parameter-status safe">Normal</div>
                                <div class="parameter-bar">
                                    <div class="parameter-progress" style="width: 68%"></div>
                                </div>
                            </div>
                            <div class="parameter-item">
                                <div class="parameter-label">Conductivity</div>
                                <div class="parameter-value">450 µS/cm</div>
                                <div class="parameter-status safe">Normal</div>
                                <div class="parameter-bar">
                                    <div class="parameter-progress" style="width: 60%"></div>
                                </div>
                            </div>
                            <div class="parameter-item">
                                <div class="parameter-label">Total Coliform</div>
                                <div class="parameter-value">0 CFU/100ml</div>
                                <div class="parameter-status safe">Safe</div>
                                <div class="parameter-bar">
                                    <div class="parameter-progress" style="width: 100%"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Action Items -->
        <div class="row">
            <div class="col-12">
                <div class="action-card">
                    <div class="action-header">
                        <h5 class="action-title">
                            <i class="fas fa-tasks me-2"></i>
                            Priority Action Items
                        </h5>
                        <div class="action-controls">
                            <button class="btn btn-sm btn-outline-primary" id="filterCritical">
                                <i class="fas fa-filter me-1"></i>Critical Only
                            </button>
                            <button class="btn btn-sm btn-outline-success" id="markAllRead">
                                <i class="fas fa-check-double me-1"></i>Mark All Read
                            </button>
                        </div>
                    </div>
                    <div class="action-body">
                        <div class="table-responsive">
                            <table class="table table-hover">
                                <thead>
                                    <tr>
                                        <th>Priority</th>
                                        <th>Location</th>
                                        <th>Issue</th>
                                        <th>Parameters</th>
                                        <th>Last Updated</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody id="actionItemsTable">
                                    <!-- Action items will be loaded here -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Station Details Modal -->
    <div class="modal fade" id="stationDetailsModal" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Station Details</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div id="stationDetailsContent">
                        <!-- Station details will be loaded here -->
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                    <button type="button" class="btn btn-primary" id="viewStationHistory">View History</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="dashboard.js"></script>
</body>
</html>